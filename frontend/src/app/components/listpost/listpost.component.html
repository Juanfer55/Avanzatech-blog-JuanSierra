<div class="post">
  <div class="post-header">
    <h1 class="title">
      {{ post.title }}
    </h1>
    <div class="post-info">
      <p class="info">Team: {{ post.author.team.name }}</p>
      <p class="info">
        {{ post.author.username }}
      </p>
      <p class="info">
        {{ post.created_at | date : "dd/MM/yyyy HH:mm:ss" }}
      </p>
    </div>
  </div>
  <div class="content-container">
    <div class="post-content">
      <p class="post-excerpt">
        {{ post.content_excerpt }}
        <span
          *ngIf="post.content_excerpt.split(' ').length === 200"
          (click)="detailView()"
          class="link"
          >Show More</span
        >
      </p>
    </div>
  </div>
  <div class="post-info">
    <div class="likes-comments">
      <div
        class="likes"
        (click)="likesIsOpen = !likesIsOpen"
        cdkOverlayOrigin
        #likesOverlay="cdkOverlayOrigin"
      >
        <p>{{ totalLikes }} Likes</p>
      </div>
      <div class="comments" (click)="detailView()">
        <p>{{ commentCount }} Comments</p>
      </div>
    </div>
    <div class="post-interaction">
      <div *ngIf="user" class="like">
        <fa-icon
          *ngIf="postIsLiked"
          (click)="unlikePost()"
          class="liked"
          [icon]="solidHeartIcon"
          size="2x"
        ></fa-icon>
        <fa-icon
          *ngIf="!postIsLiked"
          (click)="likePost()"
          class="liked"
          [icon]="regularHeartIcon"
          size="2x"
        ></fa-icon>
      </div>
      <div *ngIf="user">
        <fa-icon
          (click)="detailView()"
          [icon]="commentIcon"
          size="2x"
        ></fa-icon>
      </div>
      <div *ngIf="hasEditPermission()">
        <fa-icon [icon]="editIcon" size="2x" (click)="editView()"></fa-icon>
      </div>
      <div *ngIf="hasEditPermission()">
        <fa-icon
          [icon]="trashIcon"
          size="2x"
          (click)="openDeleteDialog()"
        ></fa-icon>
      </div>
    </div>
  </div>
</div>
<ng-template
  cdkConnectedOverlay
  [cdkConnectedOverlayOrigin]="likesOverlay"
  [cdkConnectedOverlayOpen]="likesIsOpen"
>
  <div class="likes-container">
    <div *ngIf="likes.length === 0">
      <p>No likes yet</p>
    </div>
    <div *ngIf="likes.length > 0">
      <h3>Liked by:</h3>
      <p *ngFor="let like of likes">{{ like.user.username }}</p>
      <div *ngIf="likesTotalPages > 1" class="like-navigation">
        <div *ngIf="likesPreviousPage" (click)="getLikes(likesPreviousPage)">
          <fa-icon class="like-navigation-icon" [icon]="previousIcon"></fa-icon>
        </div>
        <p>{{ likesCurrentPage }}</p>
        <div *ngIf="likesNextPage" (click)="getLikes(likesNextPage)">
          <fa-icon class="like-navigation-icon" [icon]="nextIcon"></fa-icon>
        </div>
      </div>
    </div>
  </div>
</ng-template>
